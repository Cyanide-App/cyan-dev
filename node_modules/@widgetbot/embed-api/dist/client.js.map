{"version":3,"file":"client.js","sourceRoot":"","sources":["../src/client.ts"],"names":[],"mappings":";;AAAA,+BAAuB;AAGvB,MAAM,MAAO,SAAQ,aAAmB;IAGtC,YAAY,OAAwB;QAClC,KAAK,EAAE,CAAA;QA4BF,WAAM,GAAG;YACd,IAAI,EAAE,CAA0B,KAAQ,EAAE,IAAwB,EAAE,EAAE;gBACpE,MAAM,SAAS,GAAe,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAA;gBAEnD,IAAI,SAAS,EAAE;oBACb,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAA;iBAC9C;YACH,CAAC;SACF,CAAA;QAnCC,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,OAAO,CAAC,CAAA;QAC5B,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAC,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAA;IAC1E,CAAC;IAED;;;;OAIG;IACI,IAAI,CAA0B,KAAQ,EAAE,IAAwB;QACrE,IAAI,CAAC,MAAM,CAAC,MAAM;YAAE,OAAO,KAAK,CAAA;QAEhC,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC;YAC5B,SAAS,EAAE,IAAI;YACf,EAAE,EAAE,IAAI,CAAC,EAAE;YACX,KAAK;YACL,IAAI;SACL,CAAC,CAAA;QAEF,IAAI,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE;YAC7B,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,WAAW,CAAC,MAAM,EAAE,GAAG,CAAC,CAAA;YAClD,OAAO,IAAI,CAAA;SACZ;QAED,OAAO,KAAK,CAAA;IACd,CAAC;CAWF;AAED,kBAAe,MAAM,CAAA","sourcesContent":["import API from './api'\r\nimport { IClient, IServer } from './types'\r\n\r\nclass Client extends API<IServer.Events> {\r\n  iframe: HTMLIFrameElement\r\n\r\n  constructor(options: IClient.Options) {\r\n    super()\r\n    Object.assign(this, options)\r\n    window.addEventListener('message', ({ data }) => this.socketEvent(data))\r\n  }\r\n\r\n  /**\r\n   * Emits an event to the client\r\n   * @param event Event name\r\n   * @param data Event data\r\n   */\r\n  public emit<T extends IClient.Event>(event: T, data?: IClient.Events[T]) {\r\n    if (!window.parent) return false\r\n\r\n    const parsed = JSON.stringify({\r\n      widgetbot: true,\r\n      id: this.id,\r\n      event,\r\n      data\r\n    })\r\n\r\n    if (this.iframe.contentWindow) {\r\n      this.iframe.contentWindow.postMessage(parsed, '*')\r\n      return true\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  public server = {\r\n    emit: <T extends IServer.Event>(event: T, data?: IServer.Events[T]) => {\r\n      const listeners: Function[] = this.listeners[event]\r\n\r\n      if (listeners) {\r\n        listeners.forEach(listener => listener(data))\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default Client\r\n"]}