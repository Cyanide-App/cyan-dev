{
  "version": 3,
  "sources": ["../../@widgetbot/embed-api/src/api.ts", "../../@widgetbot/embed-api/src/client.ts", "../../@widgetbot/embed-api/src/server.ts", "../../@widgetbot/embed-api/src/index.ts", "../../@widgetbot/react-embed/src/elements.ts", "../../@widgetbot/react-embed/src/util.ts", "../../@widgetbot/react-embed/src/index.tsx"],
  "sourcesContent": ["abstract class API<Events extends Object> {\r\n  id: string\r\n  listeners = {} as {\r\n    [event in keyof Events]: ((data: Events[event]) => void)[]\r\n  }\r\n\r\n  protected socketEvent(raw: string) {\r\n    try {\r\n      var message = JSON.parse(raw)\r\n    } catch (e) {\r\n      return\r\n    }\r\n\r\n    if (\r\n      message instanceof Object &&\r\n      message.widgetbot === true &&\r\n      message.id === this.id\r\n    ) {\r\n      const { event, data } = message\r\n      const listeners: Function[] = this.listeners[event]\r\n\r\n      if (listeners) {\r\n        listeners.forEach(listener => listener(data))\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Listens to events from the client\r\n   * @param event Event name\r\n   * @param callback Event callback\r\n   */\r\n  public on<T extends keyof Events>(\r\n    event: T,\r\n    callback: (data: Events[T]) => void\r\n  ) {\r\n    if (!this.listeners[event]) this.listeners[event] = []\r\n\r\n    const listeners = this.listeners[event]\r\n    listeners.push(callback)\r\n\r\n    console.debug(`[embed-api] on '${String(event)}'`, callback)\r\n  }\r\n\r\n  /**\r\n   * Remove a listener from an event from the client\r\n   * @param event Event name\r\n   * @param callback Event callback\r\n   */\r\n  public removeListener<T extends keyof Events>(\r\n    event: T,\r\n    callback: (data: Events[T]) => void\r\n  ) {\r\n    if (!this.listeners[event]) return\r\n\r\n    this.listeners[event] = this.listeners[event].filter(x => x === callback);\r\n\r\n    console.debug(`[embed-api] removeListener '${String(event)}'`, callback)\r\n  }\r\n}\r\n\r\nexport default API\r\n", "import API from './api'\r\nimport { IClient, IServer } from './types'\r\n\r\nclass Client extends API<IServer.Events> {\r\n  iframe: HTMLIFrameElement\r\n\r\n  constructor(options: IClient.Options) {\r\n    super()\r\n    Object.assign(this, options)\r\n    window.addEventListener('message', ({ data }) => this.socketEvent(data))\r\n  }\r\n\r\n  /**\r\n   * Emits an event to the client\r\n   * @param event Event name\r\n   * @param data Event data\r\n   */\r\n  public emit<T extends IClient.Event>(event: T, data?: IClient.Events[T]) {\r\n    if (!window.parent) return false\r\n\r\n    const parsed = JSON.stringify({\r\n      widgetbot: true,\r\n      id: this.id,\r\n      event,\r\n      data\r\n    })\r\n\r\n    if (this.iframe.contentWindow) {\r\n      this.iframe.contentWindow.postMessage(parsed, '*')\r\n      return true\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  public server = {\r\n    emit: <T extends IServer.Event>(event: T, data?: IServer.Events[T]) => {\r\n      const listeners: Function[] = this.listeners[event]\r\n\r\n      if (listeners) {\r\n        listeners.forEach(listener => listener(data))\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default Client\r\n", "import API from './api'\r\nimport { IClient, IServer } from './types'\r\n\r\nclass Server extends API<IClient.Events> {\r\n  targetOrigin = '*'\r\n\r\n  constructor(options: IServer.Options) {\r\n    super()\r\n    Object.assign(this, options)\r\n\r\n    window.addEventListener('message', ({ data }) => this.socketEvent(data))\r\n  }\r\n\r\n  /**\r\n   * Emits an event to the client\r\n   * @param event Event name\r\n   * @param data Event data\r\n   */\r\n  public emit<T extends IServer.Event>(event: T, data?: IServer.Events[T]) {\r\n    console.debug(`[embed-api] emit '${event}'`, data)\r\n\r\n    if (!window.parent) return false\r\n\r\n    const parsed = JSON.stringify({\r\n      widgetbot: true,\r\n      id: this.id,\r\n      event,\r\n      data\r\n    })\r\n\r\n    window.parent.postMessage(parsed, this.targetOrigin)\r\n\r\n    return true\r\n  }\r\n\r\n  public client = {\r\n    emit: <T extends IClient.Event>(event: T, data?: IClient.Events[T]) => {\r\n      const listeners: Function[] = this.listeners[event]\r\n\r\n      if (listeners) {\r\n        listeners.forEach(listener => listener(data))\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default Server\r\n", "export { default as API } from './api'\r\nexport { default as Client } from './client'\r\nexport { default as Server } from './server'\r\n", null, null, null],
  "mappings": "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",
  "names": []
}
